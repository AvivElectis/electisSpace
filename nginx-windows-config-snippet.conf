# =====================================================================
# electisSpace - Windows nginx Configuration Snippet
# =====================================================================
# Add this block INSIDE your existing server { } block for solum.co.il
# Location: Usually C:\nginx\conf\nginx.conf
#
# Example placement:
#
# server {
#     listen 80;
#     server_name solum.co.il;
#
#     # ... your existing location blocks ...
#
#     # ADD THIS BLOCK BELOW:
#
#     location /app {
#         proxy_pass http://127.0.0.1:8080;
#         ...
#     }
# }
# =====================================================================

# =============================================
# electisSpace Application — /app
# =============================================
location /app {
    # Forward to Docker nginx container on port 8080
    proxy_pass http://127.0.0.1:8080;
    proxy_http_version 1.1;

    # Standard proxy headers
    proxy_set_header Host              $host;
    proxy_set_header X-Real-IP         $remote_addr;
    proxy_set_header X-Forwarded-For   $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;

    # WebSocket support (for Socket.io if needed in future)
    proxy_set_header Upgrade    $http_upgrade;
    proxy_set_header Connection "upgrade";

    # SSE (Server-Sent Events) support — CRITICAL for real-time sync
    # These settings disable buffering for event streams
    proxy_buffering off;
    proxy_cache off;
    proxy_read_timeout 86400s;  # 24 hours for long-lived connections
    chunked_transfer_encoding off;

    # Increase max body size for file uploads
    client_max_body_size 10m;

    # Security headers (optional but recommended)
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-XSS-Protection "1; mode=block" always;
}

# =====================================================================
# After adding this, test and reload:
#
# Test:   nginx.exe -t
# Reload: nginx.exe -s reload
#
# Or restart the nginx service:
# Restart-Service nginx
# =====================================================================
